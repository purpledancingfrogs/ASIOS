# HSM Adapter Interface — Causal Binding for ASIOS / Aureon

This document defines the **Hardware Security Module (HSM) adapter interface** used by ASIOS / Aureon to achieve cryptographic causal binding between kernel admission and downstream execution.

The HSM adapter ensures that **no physical or external action can occur unless it is cryptographically authorized by the ASIOS Pre-Admissibility Execution Kernel**.

---

## Purpose

The HSM adapter provides:

- Cryptographic signing of admitted actions
- Immutable linkage between kernel decision and execution
- Hardware-enforced fail-closed behavior
- Auditor-verifiable provenance

This adapter is **optional but authoritative**.  
If present and enabled, all downstream executors **must** honor it.

---

## Interface Definition

```python
from abc import ABC, abstractmethod
from typing import Dict, Any

class AureonHSMAdapter(ABC):
    """
    Interface for Causal Binding.
    Ensures that admitted actions are cryptographically signed
    before transmission to downstream physical adapters.
    """

    @abstractmethod
    def sign_action(self, admission_token: str, action_payload: Dict[str, Any]) -> str:
        """
        Generates a cryptographic signature for an admitted action.

        admission_token:
            Single-use capability token generated by the ASIOS kernel.

        action_payload:
            Canonicalized, deterministic payload admitted by the kernel.

        Returns:
            Base64-encoded signature (JWS or equivalent).
        """
        pass

    @abstractmethod
    def verify_integrity(self) -> bool:
        """
        Performs a self-check of the HSM state and key availability.

        If this returns False, the ASIOS kernel MUST enter FAIL-CLOSED state.
        """
        pass
````

---

## Mandatory Requirements

1. **Non-Exportable Keys**

   * Private keys MUST reside inside an HSM secure enclave.
   * No software fallback is permitted when enabled.

2. **Deterministic Canonicalization**

   * Payloads MUST be canonicalized (RFC 8785 or equivalent).
   * Signature mismatches across environments are not acceptable.

3. **Single-Use Admission Tokens**

   * Admission tokens MUST NOT be reusable.
   * Replay attempts must be rejected.

4. **Downstream Enforcement**

   * Physical adapters MUST reject any command lacking a valid HSM signature.
   * Kernel authority must be enforced at the hardware boundary.

---

## Failure Semantics

* HSM unavailable → FAIL-CLOSED
* Integrity check fails → FAIL-CLOSED
* Signature mismatch → ACTION REJECTED
* Replay detected → ACTION REJECTED

No soft degradation paths exist.

---

## Scope Clarification

The HSM adapter:

* Does NOT perform mission validation
* Does NOT generate intent
* Does NOT control motion planning
* Does NOT manage real-time loops

It exists solely to bind **authorization → execution**.

---

## Versioning

* Introduced as a **reference interface** at v0.1.0
* Expected to be implemented by adopters in v0.1.1+
* No vendor lock-in implied

---

## Summary

This interface completes the ASIOS causal chain:

**Mission → Admission → Cryptographic Binding → Execution**

It transforms governance from policy into physics.
